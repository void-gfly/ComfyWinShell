<UserControl x:Class="WpfDesktop.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:WpfDesktop.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="900"
             d:DataContext="{d:DesignInstance vm:SettingsViewModel}">

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Background="#050505">
        <StackPanel Margin="80,60,80,60" MaxWidth="1000" HorizontalAlignment="Left">

            <!-- Header -->
            <TextBlock Text="è®¾ç½®" FontSize="32" FontWeight="Bold" Margin="0,0,0,8"/>
            <TextBlock Text="ç®¡ç† ComfyShell çš„å¤–è§‚ã€è¡Œä¸ºä¸Žå­˜å‚¨é…ç½®" FontSize="16" Opacity="0.6" Margin="0,0,0,40"/>

            <!-- General Section -->
            <TextBlock Text="å¸¸è§„" FontSize="18" FontWeight="SemiBold"
                       Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,20"/>

            <!-- App Name -->
            <StackPanel Margin="0,0,0,25">
                <TextBlock Text="åº”ç”¨ç¨‹åºåç§°" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Settings.AppName, UpdateSourceTrigger=PropertyChanged}"
                         Width="250" HorizontalAlignment="Left"
                         VerticalContentAlignment="Center"/>
                <TextBlock Text="è‡ªå®šä¹‰çª—å£æ ‡é¢˜æ˜¾ç¤ºçš„åç§°"
                           FontSize="12" Opacity="0.5" Margin="0,6,0,0"/>
            </StackPanel>

            <Grid Margin="0,0,0,50">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="40"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Language -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="ç•Œé¢è¯­è¨€" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding LanguageOptions}"
                              SelectedItem="{Binding Settings.Language}"/>
                    <TextBlock Text="åº”ç”¨ç¨‹åºçš„ä¸»è¦æ˜¾ç¤ºè¯­è¨€"
                               FontSize="12" Opacity="0.5" Margin="0,6,0,0"/>
                </StackPanel>

                <!-- Theme -->
                <StackPanel Grid.Column="2">
                    <TextBlock Text="é¢œè‰²ä¸»é¢˜" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding ThemeOptions}"
                              SelectedItem="{Binding Settings.Theme}"/>
                    <TextBlock Text="é€‰æ‹©æ·±è‰²æˆ–æµ…è‰²ç•Œé¢é£Žæ ¼"
                               FontSize="12" Opacity="0.5" Margin="0,6,0,0"/>
                </StackPanel>
            </Grid>

            <Border Height="1" Opacity="0.3" Margin="0,0,0,50"
                    Background="#2A2A2A"/>

            <!-- Console Section -->
            <TextBlock Text="æŽ§åˆ¶å°" FontSize="18" FontWeight="SemiBold"
                       Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,20"/>

            <StackPanel Margin="0,0,0,50">
                <TextBlock Text="æœ€å¤§æ—¥å¿—è¡Œæ•°" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Settings.MaxLogLines, UpdateSourceTrigger=PropertyChanged}"
                         Width="150" HorizontalAlignment="Left"
                         VerticalContentAlignment="Center"/>
                <TextBlock Text="æŽ§åˆ¶å°è¾“å‡ºä¿ç•™çš„æœ€å¤§è¡Œæ•°ï¼Œè¶…å‡ºåŽè‡ªåŠ¨åˆ é™¤æ—§æ—¥å¿—ã€‚é»˜è®¤ 5000 è¡Œã€‚"
                           FontSize="12" Opacity="0.5" Margin="0,6,0,0"/>
            </StackPanel>

            <Border Height="1" Opacity="0.3" Margin="0,0,0,50"
                    Background="#2A2A2A"/>

            <!-- Proxy Section -->
            <TextBlock Text="ç½‘ç»œä»£ç†" FontSize="18" FontWeight="SemiBold"
                       Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,20"/>

            <StackPanel Margin="0,0,0,25">
                <CheckBox IsChecked="{Binding Settings.Proxy.Enabled}" Margin="0,0,0,15">
                    <TextBlock Text="å¯ç”¨ä»£ç†æœåŠ¡å™¨" FontSize="14" FontWeight="Medium"/>
                </CheckBox>
                <TextBlock Text="å¯ç”¨åŽï¼ŒComfyUIã€Gitã€pip ç­‰æ‰€æœ‰ç½‘ç»œæ“ä½œéƒ½å°†é€šè¿‡ä»£ç†æœåŠ¡å™¨"
                           FontSize="12" Opacity="0.5" Margin="0,0,0,15"/>

                <TextBlock Text="ä»£ç†æœåŠ¡å™¨åœ°å€" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Settings.Proxy.Server, UpdateSourceTrigger=PropertyChanged}"
                         IsEnabled="{Binding Settings.Proxy.Enabled}"
                         Width="350" HorizontalAlignment="Left"
                         VerticalContentAlignment="Center"/>
                <TextBlock Text="ç¤ºä¾‹: http://127.0.0.1:7890 æˆ– http://proxy.example.com:8080"
                           FontSize="12" Opacity="0.5" Margin="0,6,0,15"/>

                <Grid Margin="0,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="ç”¨æˆ·å (å¯é€‰)" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                        <TextBox Text="{Binding Settings.Proxy.Username, UpdateSourceTrigger=PropertyChanged}"
                                 IsEnabled="{Binding Settings.Proxy.Enabled}"
                                 VerticalContentAlignment="Center"/>
                        <TextBlock Text="ä»£ç†æœåŠ¡å™¨éœ€è¦è®¤è¯æ—¶å¡«å†™"
                                   FontSize="12" Opacity="0.5" Margin="0,6,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="å¯†ç  (å¯é€‰)" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                        <PasswordBox x:Name="ProxyPasswordBox"
                                     IsEnabled="{Binding Settings.Proxy.Enabled}"
                                     PasswordChanged="ProxyPasswordBox_OnPasswordChanged"
                                     VerticalContentAlignment="Center"/>
                        <TextBlock Text="å¯†ç å°†åŠ å¯†å­˜å‚¨"
                                   FontSize="12" Opacity="0.5" Margin="0,6,0,0"/>
                    </StackPanel>
                </Grid>
            </StackPanel>

            <Border Height="1" Opacity="0.3" Margin="0,0,0,50"
                    Background="#2A2A2A"/>

            <!-- Mirror Settings Section -->
            <TextBlock Text="é•œåƒåŠ é€Ÿ" FontSize="18" FontWeight="SemiBold"
                       Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,20"/>

            <!-- GitHub Mirror -->
            <StackPanel Margin="0,0,0,30">
                <CheckBox IsChecked="{Binding Settings.GitHubMirror.Enabled}" Margin="0,0,0,15">
                    <TextBlock Text="å¯ç”¨ GitHub é•œåƒç«™ç‚¹" FontSize="14" FontWeight="Medium"/>
                </CheckBox>
                <TextBlock Text="åŠ é€Ÿ Git å…‹éš†ã€è‡ªå®šä¹‰èŠ‚ç‚¹ä¸‹è½½ç­‰ GitHub æ“ä½œ"
                           FontSize="12" Opacity="0.5" Margin="0,0,0,15"/>

                <TextBlock Text="GitHub é•œåƒåœ°å€" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Settings.GitHubMirror.MirrorUrl, UpdateSourceTrigger=PropertyChanged}"
                         IsEnabled="{Binding Settings.GitHubMirror.Enabled}"
                         HorizontalAlignment="Stretch"
                         VerticalContentAlignment="Center"/>
                
                <!-- å¸¸ç”¨é•œåƒåˆ—è¡¨ -->
                <TextBlock Text="å¸¸ç”¨é•œåƒ:" FontSize="12" Opacity="0.5" Margin="0,8,0,6"/>
                <StackPanel Margin="0,0,0,0">
                    <!-- é•œåƒ 1 -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,6" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://ghproxy.com/https://github.com" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="æŽ¨è - ç¨³å®šæ€§å¥½" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyGitHubMirror1_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- é•œåƒ 2 -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,6" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://mirror.ghproxy.com/https://github.com" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="å¤‡ç”¨é•œåƒ" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyGitHubMirror2_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- é•œåƒ 3 -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,0" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://gh.api.99988866.xyz/https://github.com" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="å¤‡ç”¨é•œåƒ" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyGitHubMirror3_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                </StackPanel>
            </StackPanel>

            <!-- pip Mirror -->
            <StackPanel Margin="0,0,0,25">
                <CheckBox IsChecked="{Binding Settings.PipMirror.Enabled}" Margin="0,0,0,15">
                    <TextBlock Text="å¯ç”¨ pip é•œåƒæº" FontSize="14" FontWeight="Medium"/>
                </CheckBox>
                <TextBlock Text="åŠ é€Ÿ Python åŒ…ä¸‹è½½ï¼ˆpip installï¼‰"
                           FontSize="12" Opacity="0.5" Margin="0,0,0,15"/>

                <TextBlock Text="pip é•œåƒæºåœ°å€" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Settings.PipMirror.IndexUrl, UpdateSourceTrigger=PropertyChanged}"
                         IsEnabled="{Binding Settings.PipMirror.Enabled}"
                         HorizontalAlignment="Stretch"
                         VerticalContentAlignment="Center"/>
                
                <!-- å¸¸ç”¨é•œåƒæºåˆ—è¡¨ -->
                <TextBlock Text="å¸¸ç”¨é•œåƒæº:" FontSize="12" Opacity="0.5" Margin="0,8,0,6"/>
                <StackPanel Margin="0,0,0,15">
                    <!-- é•œåƒæº 1 - æ¸…åŽ -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,6" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://pypi.tuna.tsinghua.edu.cn/simple" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="æ¸…åŽå¤§å­¦ - æŽ¨è" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyPipMirror1_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- é•œåƒæº 2 - é˜¿é‡Œäº‘ -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,6" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://mirrors.aliyun.com/pypi/simple" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="é˜¿é‡Œäº‘" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyPipMirror2_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- é•œåƒæº 3 - ä¸­ç§‘å¤§ -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,6" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://pypi.mirrors.ustc.edu.cn/simple" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyPipMirror3_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- é•œåƒæº 4 - è…¾è®¯äº‘ -->
                    <Border BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="4" Padding="8,6" Margin="0,0,0,0" Background="#0A0A0A">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="https://mirrors.cloud.tencent.com/pypi/simple" FontSize="12" Foreground="{DynamicResource PrimaryTextBrush}" FontFamily="Consolas"/>
                                <TextBlock Text="è…¾è®¯äº‘" FontSize="11" Opacity="0.5" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1" 
                                    Click="CopyPipMirror4_Click"
                                    Style="{DynamicResource SecondaryButtonStyle}"
                                    Padding="8,4"
                                    ToolTip="å¤åˆ¶åˆ°å‰ªè´´æ¿">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="å¤åˆ¶" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                </StackPanel>

                <CheckBox IsChecked="{Binding Settings.PipMirror.TrustedHost}"
                          IsEnabled="{Binding Settings.PipMirror.Enabled}"
                          Margin="0,0,0,0">
                    <TextBlock Text="ä¿¡ä»»è¯¥é•œåƒæºï¼ˆé¿å… SSL è¯ä¹¦éªŒè¯é—®é¢˜ï¼‰" FontSize="13" Opacity="0.8"/>
                </CheckBox>
            </StackPanel>

            <Border Height="1" Opacity="0.3" Margin="0,0,0,50"
                    Background="#2A2A2A"/>

            <!-- Storage Section -->
            <TextBlock Text="å­˜å‚¨ä¸Žè·¯å¾„" FontSize="18" FontWeight="SemiBold"
                       Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,20"/>

            <StackPanel Margin="0,0,0,60">
                <TextBlock Text="ComfyUI æ•°æ®æ ¹ç›®å½•" FontSize="14" FontWeight="Medium" Opacity="0.7" Margin="0,0,0,8"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0"
                             Text="{Binding Settings.DataRoot, UpdateSourceTrigger=PropertyChanged}"
                             VerticalContentAlignment="Center"/>

                    <Button Grid.Column="2"
                            Command="{Binding BrowseDataRootCommand}"
                            Content="æµè§ˆæ–‡ä»¶å¤¹..."
                            Style="{DynamicResource SecondaryButtonStyle}"/>
                </Grid>

                <TextBlock Text="æ­¤ç›®å½•ç”¨äºŽå­˜å‚¨æ‰€æœ‰æ¨¡åž‹ã€èŠ‚ç‚¹ã€å·¥ä½œæµåŠç”Ÿæˆçš„å›¾åƒã€‚æ›´æ”¹åŽå¯èƒ½éœ€è¦é‡å¯åº”ç”¨ã€‚"
                           FontSize="12" Opacity="0.5" Margin="0,10,0,0" TextWrapping="Wrap"/>
            </StackPanel>

            <!-- Footer Action -->
            <Button Command="{Binding SaveCommand}"
                    Content="ä¿å­˜é…ç½®"
                    Style="{DynamicResource PrimaryButtonStyle}"/>

        </StackPanel>
    </ScrollViewer>
</UserControl>
